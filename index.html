<html>
<head>
  <meta charset="UTF-8">
  <script src="js/p5.min.js"></script>
  <script>
    var x = 0, y = 0, estado, passos = 3;
    var posicao = 0, cont = 0, delay = 5;
        
    var x2 = 500, y2 = 500; //Coordenadas do Indio
    var posicao2 = 0, cont2 = 0;
    
    var aux, dist, aux2;
    
    var vida = 100, coracao;
    
    var Jog_Frente = [];
    var Jog_Direita = [];
    var Jog_Esquerda = [];
    var Jog_Tras = [];
    
    var Ind_Frente = [];
    var Ind_Direita = [];
    var Ind_Esquerda = [];
    var Ind_Tras = [];

    
function preload(){
  //Salva as img de movimentação dos persongagens
  
  //JOGADOR
  Jog_Frente[0] = loadImage("Imagens/Jogador - Frente0.png");
  Jog_Frente[1] = loadImage("Imagens/Jogador - Frente1.png");
  Jog_Frente[2] = loadImage("Imagens/Jogador - Frente2.png");
  Jog_Frente[3] = loadImage("Imagens/Jogador - Frente3.png");
  
  Jog_Direita[0] = loadImage("Imagens/Jogador - Direita0.png");
  Jog_Direita[1] = loadImage("Imagens/Jogador - Direita1.png");
  Jog_Direita[2] = loadImage("Imagens/Jogador - Direita2.png");
  Jog_Direita[3] = loadImage("Imagens/Jogador - Direita3.png");
  
  Jog_Esquerda[0] = loadImage("Imagens/Jogador - Esquerda0.png");
  Jog_Esquerda[1] = loadImage("Imagens/Jogador - Esquerda1.png");
  Jog_Esquerda[2] = loadImage("Imagens/Jogador - Esquerda2.png");
  Jog_Esquerda[3] = loadImage("Imagens/Jogador - Esquerda3.png");
  
  Jog_Tras[0] = loadImage("Imagens/Jogador - Trás0.png");
  Jog_Tras[1] = loadImage("Imagens/Jogador - Trás1.png");
  Jog_Tras[2] = loadImage("Imagens/Jogador - Trás2.png");
  Jog_Tras[3] = loadImage("Imagens/Jogador - Trás3.png");
  
  
  
  //ÍNDIO
  Ind_Frente[0] = loadImage("Imagens/Índio - Frente0.png");
  Ind_Frente[1] = loadImage("Imagens/Índio - Frente1.png");
  Ind_Frente[2] = loadImage("Imagens/Índio - Frente2.png");
  Ind_Frente[3] = loadImage("Imagens/Índio - Frente3.png");
    
  Ind_Direita[0] = loadImage("Imagens/Índio - Direita0.png");
  Ind_Direita[1] = loadImage("Imagens/Índio - Direita1.png");
  Ind_Direita[2] = loadImage("Imagens/Índio - Direita2.png");
  Ind_Direita[3] = loadImage("Imagens/Índio - Direita3.png");
  
  Ind_Esquerda[0] = loadImage("Imagens/Índio - Esquerda0.png");
  Ind_Esquerda[1] = loadImage("Imagens/Índio - Esquerda1.png");
  Ind_Esquerda[2] = loadImage("Imagens/Índio - Esquerda2.png");
  Ind_Esquerda[3] = loadImage("Imagens/Índio - Esquerda3.png");
  
  Ind_Tras[0] = loadImage("Imagens/Índio - Trás0.png");
  Ind_Tras[1] = loadImage("Imagens/Índio - Trás1.png");
  Ind_Tras[2] = loadImage("Imagens/Índio - Trás2.png");
  Ind_Tras[3] = loadImage("Imagens/Índio - Trás3.png");
  
  coracao = loadImage ("Imagens/Vida.png");
  
}
    
function setup() {
  createCanvas(windowWidth, windowHeight);
  aux = Jog_Frente[0];
  aux2 = Ind_Frente[0];
}

function draw() {
    background ("white");

    if(keyIsPressed == true)
      estado = key;
    else
      estado = 0;
  
      
    switch (estado){ //MOVIMENTO DO JOGADOR
      case 'ArrowUp':
        if (colisao(x, y - passos, 32, 77, x2, y2, 32, 77) == false){
          y -= passos;
          aux = Jog_Tras[posicao];
        }
        break;
      
      case 'ArrowDown':
        if (colisao(x, y + passos, 32, 77, x2, y2, 32, 77) == false){
          y += passos;
          aux = Jog_Frente[posicao];
        }
        break;
    
      case 'ArrowRight':
        if (colisao(x + passos, y, 32, 77, x2, y2, 32, 77) == false){
          x += passos;
          aux = Jog_Direita[posicao];
        }  
        break;
      
      case 'ArrowLeft':
        if (colisao(x - passos, y, 32, 77, x2, y2, 32, 77) == false){
          x -= passos;
          aux = Jog_Esquerda[posicao];
        }
        break;
    }
  
    if (keyIsPressed == true){ //Animação da sprite do jogador
      if (cont == delay){
        posicao++;
        cont = 0;
      }
      else
        cont++;
    }
    if (posicao > 3)
      posicao = 0;
  
  
  
  
    noFill();
    ellipse (x2, y2, 400, 400); //área de perseguição
    ellipse (x2, y2, 200, 200); //área de ataque
    image (aux, x, y); //Exibe o jogador com a imagem atualizada nos x e y já modificados
    
    dist = Math.sqrt( (y - y2)**2 + (x - x2)**2 );
      
     
  
    if (dist < 200){ // Área de Ataque do Indio
      
      if (cont2 == delay){//Animação da Sprite do Índio
        posicao2++;
        cont2 = 0;
      }
      else
        cont2++;
    
      if (posicao2 > 3)
        posicao2 = 0;
      
      
      // MOVIMENTAÇÃO DO INDIO
      if (x2 < x && colisao (x2 + 1, y2, 33, 77, x, y, 33, 77) == false){ //Jogador à direita do Indio 
        x2++;
        aux2 = Ind_Direita[posicao2];
      }
      if (x2 > x && colisao (x2 - 1, y2, 33, 77, x, y, 33, 77) == false){ //Jogador à esquerda do Indio
        x2--;
        aux2 = Ind_Esquerda[posicao2];
      }
      if (y2 < y && colisao (x2, y2 + 1, 33, 77, x, y, 33, 77) == false){ //Jogador abaixo do Indio
        y2++;
        aux2 = Ind_Frente[posicao2];
      }
      if (y2 > y && colisao (x2, y2 - 1, 33, 77, x, y, 33, 77) == false){ //Jogador acima do Indio 
        y2--;
        aux2 = Ind_Tras[posicao2];
      }
      
      image (aux2, x2, y2); //Exibe o Indio com imagem e coordenadas já atualizadas
    }
  else
    image (Ind_Frente[0], x2, y2);
  
  
  
  if (dist < 100){ //Área de ataque do Índio
    vida = vida - (1/5);
  }
  
  image (coracao, 100, 100);
  fill ("red");
  rect (140, 100, vida, 32);
  
   
}
    
function colisao(xA, yA, compA, altA, xB, yB, compB, altB){
  //Colisão entre dois objetos A e B.
  //Entrar com as coordenadas (x e y) bem como o comprimento e altura de ambos.
  
  if (xA + compA < xB) //A está a esquerda de B
    return false;
  if (xB < xA - compB) //A está a direita de B
    return false;
  if (yA - altB > yB) //A está embaixo de B
    return false;
  if (yA + altA < yB) //A está acima de B
    return false;
  
  return true; //Se ele não entrar em nenhuma dessas 4 situações,
               //então ele está colidindo
}
    
  
  </script>

  <style> body {padding: 0; margin: 0;} </style>
</head>

<body>
</body>
</html>
